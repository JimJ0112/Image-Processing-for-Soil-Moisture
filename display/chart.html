<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</head>
<body>

<div style="width: fit-content; height: 300px;">
  <div class="col"> <canvas id="red_chart" style="width: 500px; height: 400px;"></canvas> </div>
  <hr/>
  <div class="col"> <canvas id="green_chart" style="width: 500px; height: 400px;"></canvas> </div>
  <hr/>
  <div class="col"> <canvas id="blue_chart" style="width: 500px; height: 400px;"></canvas> </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const red_chart = document.getElementById('red_chart');
    const green_chart = document.getElementById('green_chart');
    const blue_chart = document.getElementById('blue_chart');

    var r_channel_data = [];
    var g_channel_data= [];
    var b_channel_data= [];

  function loadRedChart(){
    var labels = ["X","Y"];
    const data = {
      label:labels,
      datasets: [{
        label: 'DN(r)',
        data: r_channel_data,
        backgroundColor: 'red'
      }]
    };

    new Chart(red_chart, {
      type: 'scatter',
      data: data,
      options :{
        scales: {
          x: {
            display: true,
            title: {
              display: true,
              text: 'red DN values',

            }
          },
          y: {
            display: true,
            title: {
              display: true,
              text: 'MC values (%)',

            }
          } 
        }
      }
      
    });
  }

  function loadGreenChart(){
    var labels = ["X","Y"];
    const data = {
      label:labels,
      datasets: [{
        label: 'DN(g)',
        data: g_channel_data,
        backgroundColor: 'green'
      }]
    };

    new Chart(green_chart, {
      type: 'scatter',
      data: data,
      options :{
        scales: {
          x: {
            display: true,
            title: {
              display: true,
              text: 'green DN values',
            }
          },
          y: {
            display: true,
            title: {
              display: true,
              text: 'MC values (%)',
            }
          } 
        }
      }
      
    });
  }

  function loadBlueChart(){
    var labels = ["X","Y"];
    const data = {
      label:labels,
      datasets: [{
        label: 'DN(b)',
        data: b_channel_data,
        backgroundColor: 'blue'
      }]
    };

    new Chart(blue_chart, {
      type: 'scatter',
      data: data,
      options :{
        scales: {
          x: {
            display: true,
            title: {
              display: true,
              text: 'blue DN values',
            }
          },
          y: {
            display: true,
            title: {
              display: true,
              text: 'MC values (%)',
            }
          } 
        }
      }
      
    });
  }


  function getImageProcessingResults() {
     
     var xmlhttp = new XMLHttpRequest();
 
     xmlhttp.onload = function() {
         if (this.readyState === 4 || this.status === 200){ 
             var dataArray = this.response;
             dataArray = JSON.parse(dataArray);
             var dataArrayLength = Object.keys(dataArray).length;
             for(var i=1; i< dataArrayLength; i++){
                var r_coordinates = {'x':dataArray[i]['r'],'y':dataArray[i]['mc']}
                var g_coordinates = {'x':dataArray[i]['g'],'y':dataArray[i]['mc']}
                var b_coordinates = {'x':dataArray[i]['b'],'y':dataArray[i]['mc']}
                
                r_channel_data.push(r_coordinates);
                g_channel_data.push(g_coordinates);
                b_channel_data.push(b_coordinates);
                
             }
             loadRedChart();
             loadGreenChart();
             loadBlueChart()
         }else{
 
         }      
     };
     xmlhttp.open("POST", "http://localhost/image-processing-for-soil-moisture/image_processing.php", true);
     xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
     xmlhttp.send();
     
  }// end of function
  getImageProcessingResults();
 

</script>

</body>
</html>